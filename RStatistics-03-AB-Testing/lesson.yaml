- Class: meta
  Course: StatMLDM
  Lesson: RStatistics-03-AB-Testing
  Author: Johnson Hsieh
  Type: Standard
  Organization: Taiwan R User Group
  Version: 2.3.1.2
- Class: text
  Output: |
    A/B測試 (A/B Testing)，又稱隨機對照實驗 (Random Control Trial, RCT)
    是一種透過實驗方式比較方案成效的統計方法，也是一種能夠驗證因果關係的方式。
    透過以下範例將帶同學熟悉如何在R 中進行A/B測試。
- Class: cmd_question
  Output: |
    範例1. 板球顏色與球員移動速度實驗，實驗數據收錄在變數`cricket_color`中。
    請同學輸入`cricket_color`以觀察這份實驗數據。
  CorrectAnswer: cricket_color
  AnswerTests: omnitest('cricket_color')
  Hint: cricket_color
- Class: text
  Output: |
    這份資料共包含兩個欄位，板球顏色(color, 1=red, 2=white)、移動初速(speed, 毫秒)。
- Class: cmd_question
  Output: |
    練習使用R 套件 `dplyr` 對 `cricket_color` 做敘述統計，請同學先輸入`skip()`檢查有無安裝dplyr套件。
  CorrectAnswer: check_then_install("dplyr", "0.4.3")
  AnswerTests: test_package_version("dplyr", "0.4.3")
  Hint: check_then_install("dplyr", "0.4.3")
- Class: cmd_question
  Output: |
    接著請同學載入dplyr套件
  CorrectAnswer: library(dplyr)
  AnswerTests: test_search_path("dplyr")
  Hint: library(dplyr)
- Class: script
  Output: |
    請使用`dplyr`對不同板球顏色分別計算移動初速的平均數與標準差。
    完成後，請存檔並回到console輸入`submit()`
  Script: rstatistics-03-01-01.R
  AnswerTests: rstatistics_03_01_01()
- Class: text
  Output: |
    紅色球設定之下，球員的平均(標準差)移動初速為 156.667 (31.213)；
    白色球設定之下，球員的平均(標準差)移動初速為 111.000 (20.100)。
    看起來兩種顏色對於球員移動初速的平均值有所差異，標準差也有差異。
- Class: cmd_question
  Output: |
    練習使用R 內建的 plot 函數做視覺化篩檢，
    請同學輸入 `plot(speed~color, data=cricket_color)`
  CorrectAnswer: plot(speed~color, data=cricket_color)
  AnswerTests: omnitest('plot(speed~color, data=cricket_color)')
  Hint: plott(speed~color, data=cricket_color)
- Class: text
  Output: |
    觀察boxplot可以發現，左圖(color=red)的box明顯高於右圖，
    也就是說紅色球讓球員有高於白色球的移動初速。
    本例中的 boxplot 是一種適合作為比較不同試驗方案優劣的dashboard。
- Class: text
  Output: |
    然而在實務上，我們仍需要一個數值指標作為差異性的自動化篩檢。
    古典統計學會使用p值作為衡量標準。
- Class: cmd_question
  Output: |
    練習使用R 內建的 T-test 函數做A/B測試，並計算p值，
    請同學輸入 `t.test(speed~color, data=cricket_color)`
  CorrectAnswer: t.test(speed~color, data=cricket_color)
  AnswerTests: omnitest('t.test(speed~color, data=cricket_color)')
  Hint: t.test(speed~color, data=cricket_color)
- Class: text
  Output: |
    由上述結果可知 p值=0.0177，表示在兩種顏色沒有差異的假設下，比觀察值更極端的機率為0.0177。
    關於p值的解釋請參考 <https://en.wikipedia.org/wiki/P-value>
- Class: text
  Output: |
    範例2. 考慮A、B兩種網頁排版方案，比較會員註冊的成效。
    在同一時間內隨機分派訪客進入A、B兩種排版的網頁，其中A版本在2,981個瀏覽數中有343個註冊數；
    B版本在2,945個瀏覽數中有403個註冊數。A版本的轉換率為11.5%；B版本為13.7%。
- Class: cmd_question
  Output: |
    練習使用R 內建的比例檢定函數做轉換率A/B測試，並計算p值，
    請同學輸入 `prop.test(x=c(343,403), n=c(2981,2945))`
  CorrectAnswer: prop.test(x=c(343,403), n=c(2981,2945))
  AnswerTests: omnitest('prop.test(x=c(343,403), n=c(2981,2945))')
  Hint: prop.test(x=c(343,403), n=c(2981,2945))
- Class: script
  Output: |
    轉換率問題，也可以使用`t.test`達到類似的結果。
    完成後，請存檔並回到console輸入`submit()`
  Script: rstatistics-03-02-01.R
  AnswerTests: rstatistics_03_02_01()
- Class: text
  Output: |
    範例3. 手機遊戲的儲值AB測試，這筆資料的單位已經被模糊化。
    這個範例將說明AB測試一個很重要的議題，不能夠隨意停止實驗。
- Class: cmd_question
  Output: |
    這筆資料已經被預載到`game`這個變數中，請同學輸入`summary(game)`來觀察這筆資料。
  CorrectAnswer: summary(game)
  AnswerTests: omnitest('summary(game)')
  Hint: summary(game)
- Class: text
  Output: |
    這份資料從2015-03-01開始，每一個禮拜記錄一次；method=A/B 表示兩群會員；
    value表示這群會員的儲值量；cumvalue則為累進儲值量。
    在2015-05-24之前，A/B兩組會員是使用相同促銷方案，此後開始區分不同方案。
- Class: cmd_question
  Output: |
    請使用R套件 `ggplot2` 對這筆資料做基本的視覺化，
    請同學輸入以下指令檢查套件ggplot2：`skip()`
  CorrectAnswer: check_then_install("ggplot2", "2.0.0")
  AnswerTests: test_package_version("ggplot2", "2.0.0")
  Hint: check_then_install("ggplot2", "2.0.0")
- Class: cmd_question
  Output: |
    接著請同學載入ggplot2套件
  CorrectAnswer: library(ggplot2)
  AnswerTests: test_search_path("ggplot2")
  Hint: library(ggplot2)
- Class: cmd_question
  Output: |
    請使用ggplot2繪製line cahrt，
    請同學輸入以下指令：`ggplot(game, aes(x=as.Date(date), y=value, colour=method)) + geom_line()`
  CorrectAnswer: ggplot(game, aes(x=as.Date(date), y=value, colour=method)) + geom_line()
  AnswerTests: omnitest('ggplot(game, aes(x=as.Date(date), y=value, colour=method))
    + geom_line()')
  Hint: ggplot(game, aes(x=as.Date(date), y=value, colour=method)) + geom_line()
- Class: cmd_question
  Output: |
    請同學輸入以下指令，將`ggplot`存入變數`g`：`g <- ggplot(game, aes(x=as.Date(date), y=value, colour=method)) + geom_line()`
  CorrectAnswer: g <- ggplot(game, aes(x=as.Date(date), y=value, colour=method)) +
    geom_line()
  AnswerTests: omnitest('g <- ggplot(game, aes(x=as.Date(date), y=value, colour=method))
    + geom_line()')
  Hint: g <- ggplot(game, aes(x=as.Date(date), y=value, colour=method)) + geom_line()
- Class: cmd_question
  Output: |
    經查我們知道2015-05-24才開始實驗，而A/B方案在2015-08-30產生黃金交叉。
    請同學輸入以下指令，對兩個日期做註記：`node <- as.numeric(as.Date(c("2015-05-24", "2015-08-30")))`
  CorrectAnswer: node <- as.numeric(as.Date(c("2015-05-24", "2015-08-30")))
  AnswerTests: omnitest('node <- as.numeric(as.Date(c("2015-05-24", "2015-08-30")))')
  Hint: node <- as.numeric(as.Date(c("2015-05-24", "2015-08-30")))
- Class: cmd_question
  Output: |
    請同學輸入以下指令，將兩個日期劃到ggplot上：`g + geom_vline(xintercept = node, lty=2)`
  CorrectAnswer: g + geom_vline(xintercept = node, lty=2)
  AnswerTests: omnitest('g + geom_vline(xintercept = node, lty=2)')
  Hint: g + geom_vline(xintercept = node, lty=2)
- Class: script
  Output: |
    假設自2015-05-24起，做三個月的A/B測試，即2015-05-24至2015-08-23。
    請同學在 rstatistics-03-03-01.R 裡面進行作答，
    完成後，請存檔並回到console輸入`submit()`
  Script: rstatistics-03-03-01.R
  AnswerTests: rstatistics_03_03_01()
- Class: mult_question
  Output: |
    請問同學，在上例中哪種方案表現較佳？
  AnswerChoices: A;B
  CorrectAnswer: B
  AnswerTests: omnitest(correctVal = "B")
- Class: script
  Output: |
    假設自2015-05-24起，做六個月的A/B測試，即2015-05-24至2015-11-22。
    請同學在 rstatistics-03-03-02.R 裡面進行作答，
    完成後，請存檔並回到console輸入`submit()`
  Script: rstatistics-03-03-02.R
  AnswerTests: rstatistics_03_03_02()
- Class: mult_question
  Output: |
    請問同學，在上例中哪種方案表現較佳？
  AnswerChoices: A;B
  CorrectAnswer: A
  AnswerTests: omnitest(correctVal = "A")

